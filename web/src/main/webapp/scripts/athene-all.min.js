jQuery.cookie=function(d,h,c){if(arguments.length>1&&String(h)!=="[object Object]"){c=jQuery.extend({},c);if(h===null||h===void 0)c.expires=-1;if(typeof c.expires==="number"){var b=c.expires,a=c.expires=new Date;a.setDate(a.getDate()+b)}h=String(h);return document.cookie=[encodeURIComponent(d),"=",c.raw?h:encodeURIComponent(h),c.expires?"; expires="+c.expires.toUTCString():"",c.path?"; path="+c.path:"",c.domain?"; domain="+c.domain:"",c.secure?"; secure":""].join("")}c=h||{};a=c.raw?function(a){return a}:
decodeURIComponent;return(b=RegExp("(?:^|; )"+encodeURIComponent(d)+"=([^;]*)").exec(document.cookie))?a(b[1]):null};
(function(d){var h=/["\\\x00-\x1f\x7f-\x9f]/g,c={"":"\\b","\t":"\\t","\n":"\\n","":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};d.toJSON=typeof JSON==="object"&&JSON.stringify?JSON.stringify:function(b){if(b===null)return"null";var a=typeof b;if(a!=="undefined"){if(a==="number"||a==="boolean")return""+b;if(a==="string")return d.quoteString(b);if(a==="object"){if(typeof b.toJSON==="function")return d.toJSON(b.toJSON());if(b.constructor===Date){var f=b.getUTCMonth()+1,i=b.getUTCDate(),l=b.getUTCFullYear(),
a=b.getUTCHours(),g=b.getUTCMinutes(),j=b.getUTCSeconds(),b=b.getUTCMilliseconds();f<10&&(f="0"+f);i<10&&(i="0"+i);a<10&&(a="0"+a);g<10&&(g="0"+g);j<10&&(j="0"+j);b<100&&(b="0"+b);b<10&&(b="0"+b);return'"'+l+"-"+f+"-"+i+"T"+a+":"+g+":"+j+"."+b+'Z"'}if(b.constructor===Array){f=[];for(i=0;i<b.length;i++)f.push(d.toJSON(b[i])||"null");return"["+f.join(",")+"]"}i=[];for(l in b){a=typeof l;if(a==="number")f='"'+l+'"';else if(a==="string")f=d.quoteString(l);else continue;a=typeof b[l];a==="function"||a===
"undefined"||(a=d.toJSON(b[l]),i.push(f+":"+a))}return"{"+i.join(",")+"}"}}};d.evalJSON=typeof JSON==="object"&&JSON.parse?JSON.parse:function(b){return eval("("+b+")")};d.secureEvalJSON=typeof JSON==="object"&&JSON.parse?JSON.parse:function(b){if(/^[\],:{}\s]*$/.test(b.replace(/\\["\\\/bfnrtu]/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return eval("("+b+")");else throw new SyntaxError("Error parsing JSON, source is not valid.");
};d.quoteString=function(b){if(b.match(h))return'"'+b.replace(h,function(a){var f=c[a];if(typeof f==="string")return f;f=a.charCodeAt();return"\\u00"+Math.floor(f/16).toString(16)+(f%16).toString(16)})+'"';return'"'+b+'"'}})(jQuery);
window.athene||function(){var d=window,h=document,c={addModule:function(b,a){this[b]=this[b]||a},apply:function(b,a){if(b&&typeof b==="object"&&a&&typeof a==="object")for(var f in a){var i=a[f];i!==void 0&&i!==null&&(b[f]=i)}}};c.addModule("core",{$I:function(b){return jQuery("#"+b)},DI:function(b){return h.getElementById(b)},KS:function(){d.log&&log.debug("try to keep session!");$.ajax({url:"keepSession"})},queryTodayTaskNotification:function(){$.ajax({url:"queryTodayTaskNotification",context:this,
dataType:"json",success:function(b){if(b)if(b.returnCode===4||b.returnCode===2)athene.dialog.error(b.exceptionDesc);else if(b.returnCode===3)athene.dialog.alertException(b.exceptionDesc);else{if(b.returnCode===0){var a=[],b=b.data,f=b.length;if(f>0){for(var i=0;i<f;i++){var l=b[i];a.push("<div class='task-float'><span class='task-float-number'>"+(i+1)+".</span><a");l.taskNotificationStatus==="unread"&&a.push(" class='task-float-unread'");a.push(" href='javascript:void(0)'");a.push(" onclick=\"athene.page.taskEdit({openerNumber:101,title:'"+
l.title+"',id:"+l.id+'},this);">');a.push(l.title);a.push("</a></div>")}athene.message.openMessage({title:"今日任务一览",width:300,height:200,message:a.join(""),closeable:!0})}}}else athene.dialog.error("无任何返回信息")}})},getLogConsole:function(b){$.ajax({url:"getLogConsole",context:this,success:function(a){c.env.set("logConsole",a);b&&b.call(this)}})},getDesktopMenus:function(b){$.ajax({url:"getDesktopMenus",context:this,success:function(a){var f=athene.desktop.get("desktop-default").getDmenubar();f.list=
a.data;f.renderMenus();b&&b.call(this)}})},getActiveWindowSize:function(){var b=$(d),a=$(h),f=b.width(),b=b.height(),i=a.width(),a=a.height();return{width:f>=i?f:i,height:b>=a?b:a}}});d.athene=c;d.$I=c.core.$I;d.DI=c.core.DI;d.json=$.toJSON}();
(function(){String.prototype.replaceAll=function(c,b){return this.replace(RegExp(c,"gm"),b)};String.prototype.contains=function(c){return this.indexOf(c)!==-1};String.prototype.endWith=function(c){if(c==null||c==""||this.length==0||c.length>this.length)return!1;return this.substring(this.length-c.length)==c};String.prototype.startsWith=function(c){if(c==null||c==""||this.length==0||c.length>this.length)return!1;return this.substr(0,c.length)==c};var d=window.athene,h=function(){return!1};$.fn.closeSelect=
function(){d.env.get("isFF")?this.get(0).style.MozUserSelect="none":d.env.get("isWK")?this.get(0).style.WebkitUserSelect="none":this.bind("selectstart",h);return this};$.fn.openSelect=function(){d.env.get("isFF")?this.get(0).style.MozUserSelect="auto":d.env.get("isWK")?this.get(0).style.WebkitUserSelect="auto":this.unbind("selectstart",h);return this};$.fn.doFocus=function(){this.find(":text,:password,textarea").each(function(c,b){b.readOnly||$(b).bind({focus:function(){d.dom.addClass(b,"input-focus")},
blur:function(){d.dom.removeClass(b,"input-focus")}})})};$.fn.getRow=function(){var c={};this.find(":text,input:checked,:password,:radio,:hidden,select,textarea").each(function(b,a){if(a.name&&a.value){c||(c={});var f=a.name;c[f]?c[f]+=","+a.value:c[f]=a.value}});return c}})();
window.athene.env||function(){var d=window.athene,h=window,c=document,b={dragObj:null,mousePos:null},a={get:function(a){return b[a]},getAll:function(){return b},set:function(a,i){b[a]=i}};d.addModule("env",a);(function(f,b){var l=function(){for(var g=3,j=document.createElement("div"),a=j.getElementsByTagName("i");j.innerHTML="<\!--[if gt IE "+ ++g+"]><i></i><![endif]--\>",a[0];);return g>4?g:void 0}(),g=!1,j=!1,c=!1,d=!1,h=!1,x=!1,v=!1,n=!1,m=!1,p=!1,s=!1;l?(g=!0,l===6&&(j=!0),l===7&&(c=!0),l===8&&
(d=!0),l===9&&(h=!0)):(x=!!b.getBoxObjectFor||"mozInnerScreenX"in f,v=!!f.opera&&!!f.opera.toString().indexOf("Opera"),n=/^function \(/.test([].sort),m=!!f.devicePixelRatio,p=/a/.__proto__=="//",s=/s/.test(/a/.toString));a.set("isIE",g);a.set("isIE6",j);a.set("isIE7",c);a.set("isIE8",d);a.set("isIE9",h);a.set("isFF",x);a.set("isOP",v);a.set("isOP9",n);a.set("isWK",m);a.set("isSF",p);a.set("isCR",s)})(h,c);a.set("baseUrl",c.getElementsByTagName("base")[0].href);a.get("isIE6")||a.get("isIE7")||a.get("isIE8")?
(a.set("speed",0),a.set("window_speed",0),a.set("task_speed",0)):(a.set("speed",200),a.set("window_speed",350),a.set("task_speed",500));$.ajaxSetup({type:"post",cache:!1,timeout:12E4,error:function(f){if(f.status==403)d.dialog.error("无权限");else if(f.status==401)window.location.href=a.get("baseUrl")}})}();
window.athene.dom||function(){var d={getElement:function(d){var c=void 0;switch(typeof d){case "string":c=DI(d);break;default:c=d}return c},hasClass:function(h,c){var b=d.getElement(h);if(b)for(var b=b.className.split(" "),a=b.length,f=0;f<a;f++)if(b[f]==c)return!0;return!1},addClass:function(h,c){var b=d.getElement(h);if(b&&d.hasClass(b,c)===!1){var a=b.className;a.length==0?a=c:a+=" "+c;b.className=a}},removeClass:function(h,c){var b=d.getElement(h);if(b)for(var a=b.className.split(" "),f=a.length,
i=0;i<f;i++)if(a[i]==c){a.splice(i,1);break}b.className=a.join(" ")},replaceClass:function(h,c){var b=d.getElement(h);if(b)b.className=c}};window.athene.addModule("dom",d)}();
window.athene.util||function(){var d=window.athene;d.addModule("util",{merge:function(d,c){var b={};if(d&&typeof d==="object")for(var a in d)b[a]=d[a];if(c&&typeof c==="object")for(a in c)b[a]=c[a];return b},getTimestamp:function(){return(new Date).getTime()+""},random:function(d){var c=Math.random();return d?parseInt(c*d):c},isException:function(d){return d==="ValidationException"||d==="OptimisticLockException"?!1:!0},isValidationException:function(d){return d==="ValidationException"?!0:!1},getWidght:function(h){if(h&&
h.xtype&&h.widgetId){var c=h.xtype,h=h.widgetId;if(c==="task")return d.task.get(h);else if(c==="taskbar")return d.taskbar.get(h);else if(c==="desktop")return d.desktop.get(h);else if(c==="dmenubar")return d.dmenubar.get(h);else if(c==="windowmanager")return d.windowmanager.get(h);else if(c==="grid")return d.grid.get(h);else if(c==="checkgroup")return d.checkgroup.get(h);else if(c==="listfield")return d.listfield.get(h);else if(c==="window")return d.window.get(h);else if(c==="form")return d.form.get(h);
else if(c==="dialog")return d.dialog.get(h)}return null},fetchNumber:function(d){return(d=d.replace(/[^\d]/g,""))?parseInt(d):d}})}();
window.athene.interaction||function(){var d=window.athene,h=document,c=d.env,b=function(a){this._constructor(a);this._init();this._bindEvent()};b.prototype={_constructor:function(a){d.apply(this,a)},_init:function(){$I(this.src);if($I(this.tar).css("position")!=="absolute")throw Error("source position must be absolute");this.start()},start:function(){$I(this.src).css("cursor","move");this.running=!0},stop:function(){$I(this.src).css("cursor","default");this.running=!1},isRunning:function(){return this.running},
mousemove:function(a){var f=c.get("dragObj"),b=c.get("mousePos");if(f&&b){if(this.beforeCalled!==!0)this.before&&this.before.call(this.scope||this),this.beforeCalled=!0;var l=a.pageX-b.pageX,g=a.pageY-b.pageY;if(c.get("isIE6")||c.get("isIE7")||c.get("isIE8"))var j=c.get("dottedFrame"),f=j.position(),j=j.get(0);else j=f.get(0),f=f.position();g=f.top+g;if(!(g<0))j.style.left=f.left+l+"px",j.style.top=g+"px",b.pageX=a.pageX,b.pageY=a.pageY}},mouseup:function(){if(c.get("isIE6")||c.get("isIE7")||c.get("isIE8")){var a=
c.get("dottedFrame"),f=c.get("dragObj");if(a&&f)o=f.get(0),pos=a.position(),o.style.left=pos.left+"px",o.style.top=pos.top+"px",a.remove()}$("body").openSelect();c.set("dottedFrame",null);c.set("dragObj",null);c.set("mousePos",null);$(h).unbind("mousemove",$.proxy(this.mousemove,this));this.beforeCalled=!1;this.after&&this.after.call(this.scope||this)},mousedown:function(a){if(this.running===!0){var f=$("body"),b=$(h),l=$I(this.tar);if(c.get("isIE6")||c.get("isIE7")||c.get("isIE8")){l.get(0);var g=
l.outerWidth(!0),j=l.outerHeight(!0),w=l.position().left,d=l.position().top,u=l.css("z-index");f.append("<div id='dotted-frame' class='dotted-frame' style='z-index:"+(u+1)+";width:"+g+"px;height:"+j+"px;left:"+w+"px;top:"+d+"px;'></div>");c.set("dottedFrame",$I("dotted-frame"))}c.set("dragObj",l);c.set("mousePos",{pageX:a.pageX,pageY:a.pageY});f.closeSelect();b.mousemove($.proxy(this.mousemove,this));b.one("mouseup",$.proxy(this.mouseup,this))}},_bindEvent:function(){$I(this.src).mousedown($.proxy(this.mousedown,
this))},destory:function(){$I(this.src).unbind("mousedown",this.mousedown);this.after=this.before=this.scope=null}};d.addModule("interaction",{draggable:function(a){return new b({src:a.src,tar:a.tar,before:a.before,after:a.after,scope:a.scope})}})}();
window.athene.task||function(){var d=window.athene,h=athene.dom,c=d.env,b={tasks:[]},a=function(a){this._constructor(a);this._init();this._render();this._bindEvent()};a.prototype={_constructor:function(a){if(!a)throw Error("Task未设置config");if(!a.binding)throw Error("Task未设置binding");if(!a.number)throw Error("Task未设置number");if(!a.title)throw Error("Task未设置title");b.tasks.push(this);d.apply(this,a)},_init:function(){var a=this.number;this.id="taskbar-task-"+a;this.windowId="win-"+a},_render:function(){var a=
[];a.push("<div id='"+this.id+"' class='taskbar-task-wrap'><div class='taskbar-task'>");a.push("<div class='taskbar-task-icon "+(this.iconCls?this.iconCls+"-32":"task-icon-default")+"'></div>");a.push("<div class='taskbar-task-content'>"+this.title+"</div></div></div>");d.taskbar.get(this.binding).el.find(".taskbar-task-list").append(a.join(""));this.el=$I(this.id);this._renderProxy()},_renderProxy:function(){var a=this.el.clone().appendTo("body").addClass("taskbar-task-proxy").attr("id",this.id+
"-proxy");if(this.initPosition===void 0||this.initPosition===null){var b={top:this.getBindingTaskbar().getBindingDesktop().getSizeWithoutTaskbar().height+2,left:-44};this.initPosition=b}b=this.initPosition;a.width(1).height(1).css("top",b.top+"px").css("left",b.left+"px");b=this.el.offset();this.animate(a,{opacity:1,width:160,height:40,left:b.left,top:b.top},function(){this.el.css("opacity",1).css("visibility","visible").show();a.remove()},c.get("task_speed"))},destroy:function(){var a=this.el.clone().appendTo("body").addClass("taskbar-task-proxy").attr("id",
this.id+"-proxy"),i=this.initPosition,l=this.el.offset();a.css("top",l.top+"px").css("left",l.left+"px");i={opacity:0,width:0,height:0,left:i.left,top:i.top};this.el.hide();this.animate(a,i,function(){for(var g=b.tasks,j=g.length,i=0;i<j;i++)if(this.id===g[i].id){g.splice(i,1);break}a.remove();this.el.unbind().remove();this.el=null},c.get("task_speed"))},animate:function(a,b,l,g){if(this.isAnimate!==!0)this.isAnimate=!0,g=g||c.get("speed"),a.animate({width:b.width+"px",height:b.height+"px",opacity:b.opacity,
top:b.top+"px",left:b.left+"px"},g,$.proxy(function(){this.isAnimate=!1;l&&l.call(this)},this))},setActive:function(){h.addClass(this.el.find(".taskbar-task").get(0),"taskbar-task-hover")},setUnactive:function(){h.removeClass(this.el.find(".taskbar-task").get(0),"taskbar-task-hover")},_bindEvent:function(){this.el.mousedown($.proxy(function(){var a=this.windowId,b=d.taskbar.get(this.binding),b=d.desktop.get(b.binding),b=d.windowmanager.get(b.windowManager.widgetId),l=b.getActiveWindow();l&&l.id===
a?b.hideWindow(a):b.frontWindow(a)},this))},getBindingTaskbar:function(){return d.taskbar.get(this.binding)}};d.addModule("task",{create:function(b){return{widgetId:(new a(b)).id,xtype:"task"}},get:function(a){for(var i=b.tasks,l=i.length,g=0;g<l;g++){var j=i[g];if(a===j.id)return j}return null},getAll:function(){return b.tasks}})}();
window.athene.taskbar||function(){var d=window.athene,h=d.task,c={taskbars:[]},b=function(a){this._constructor(a);this._init();this._render();this.setSize();this._bindEvent()};b.prototype={_constructor:function(a){c.taskbars.push(this);for(var b in a)this[b]=a[b]},_init:function(){this.el=$I(this.id);this.list=[]},_render:function(){var a=[];a.push("<div class='taskbar-left'><div class='taskbar-start-wrap'><div class='taskbar-start' onmouseover=\"athene.dom.addClass(this,'taskbar-start-hover');\" onmouseout=\"athene.dom.removeClass(this,'taskbar-start-hover');\"></div></div><div class='taskbar-task-list-wrap'>");
a.push("<div class='taskbar-task-list'></div></div></div><div class='taskbar-right'>");a.push("<div class='win-min-all' onmouseover=\"athene.dom.addClass(this,'win-min-all-hover');\"");a.push(" onmouseout=\"athene.dom.replaceClass(this,'win-min-all')\"");a.push(" onmousedown=\"athene.dom.addClass(this,'win-min-all-active');\"");a.push(" onmouseup=\"athene.dom.removeClass(this,'win-min-all-active');\"></div></div>");this.el.append(a.join(""));this.el.closeSelect();this.listEl=this.el.find(".taskbar-task-list")},
_bindEvent:function(){this.el.find(".taskbar-start").click(function(){d.dialog.ok("designed by 艺术人生？？")});this.el.find(".win-min-all").click($.proxy(function(){this.getBindingDesktop().getWindowManager().minAllWindow()},this))},setSize:function(a){if(typeof a==="number"&&a>0){var b=this.el.find(".taskbar-start-wrap").outerWidth(!0),i=this.el.find(".taskbar-right").outerWidth(!0),b=a-b-i;b>0&&(this.el.width(a),this.el.find(".taskbar-task-list-wrap").width(b))}},setPosition:function(a,b){var i=this.el.get(0).style;
i.top=b+"px";i.left=a+"px"},appendTask:function(a){if(!a)throw Error("TaskConfig无效");a.binding=this.id;a=h.create(a);this.list.push(a);this.setActiveTask(a.widgetId)},setActiveTask:function(a){if(this.activeTask){var b=h.get(this.activeTask);b&&b.setUnactive();delete this.activeTask}if(a&&(b=h.get(a)))b.setActive(),this.activeTask=a},removeTask:function(a){for(var b=this.list,i=b.length,l=0;l<i;l++)if(b[l].widgetId===a){h.get(a).destroy();b.splice(l,1);break}},getBindingDesktop:function(){return d.desktop.get(this.binding)}};
d.addModule("taskbar",{create:function(a){return{widgetId:(new b(a)).id,xtype:"taskbar"}},get:function(a){for(var b=c.taskbars,i=b.length,l=0;l<i;l++){var g=b[l];if(a===g.id)return g}return null},getAll:function(){return c.taskbars}})}();
window.athene.dmenubar||function(){var d=window.athene,h=d.env,c=d.dom,b={dmh:91,dmenubars:[]},a=function(a){this._constructor(a);this._init()},f={_constructor:function(a){b.dmenubars.push(this);for(var f in a)this[f]=a[f]},_init:function(){this.el=$I(this.id);this.el.closeSelect();this.list=[]},_bindEvent:function(){this.el.find(".dm").each(function(a,b){$(b).mousedown(function(g){f.focusMenu(b);g.stopPropagation()})});this.el.mousedown($.proxy(function(){this.focusMenu(null)},this))},setSize:function(a,
b){if(typeof a==="number"&&a>0&&typeof b==="number"&&b>0){var g=this.el.get(0).style;g.width=a+"px";g.height=b+"px";this.renderMenus()}},focusMenu:function(a){this.activeMenu&&(c.removeClass(this.activeMenu,"dm-focus"),delete this.activeMenu);if(a)c.addClass(a,"dm-focus"),this.activeMenu=a},renderMenus:function(a){a&&a.length>0&&(this.list=a);var a=this.el,f=[],g=this.list,j=g.length,c=b.dmh,d=a.outerHeight(!0),c=parseInt(d/c);d-=15;f.push("<div class='dm-container' style='height:"+d+"px;'>");for(var u=
0;u<j;u++){var x=u+1,v=g[u],n=h.get("desktopMenu"),n=n.replaceAll("{ondblclick}",v.onclick+"athene.dmenubar.get('"+this.id+"').focusMenu(null);"),n=n.replaceAll("{content}",v.description);v.imageUrl&&(n=n.replaceAll("dm-icon-default",v.imageUrl+"-48"));f.push(n);x%c===0&&x!=j&&f.push("</div><div class='dm-container' style='height:"+d+"px;'>")}f.push("</div>");a.html(f.join(""));this._bindEvent()}};a.prototype=f;d.addModule("dmenubar",{create:function(b){return{widgetId:(new a(b)).id,xtype:"dmenubar"}},
get:function(a){for(var f=b.dmenubars,g=f.length,j=0;j<g;j++){var c=f[j];if(a===c.id)return c}return null},getAll:function(){return b.dmenubars}})}();
window.athene.window||function(){var d=window.athene,h=window,c=athene.env,b=d.util,a=d.interaction,f={windows:[]},i=function(a){this._constructor(a);this._init();this._render();this._bindEvent()};i.prototype={_constructor:function(a){f.windows.push(this);this.cls="win-default";this.maxButton=!0;d.apply(this,a)},_init:function(){this.step={};this.xtype="window";this.items=[];this.status="normal";this.isAnimate=!1},_render:function(){var a=this.number,g=c.get("window").replaceAll("{random}",a).replaceAll("{cls}",
this.cls);this.iconCls&&(g=g.replaceAll("win-icon-default",this.iconCls+"-16"));d.windowmanager.get(this.binding).el.append(g);this.id="win-"+a;this.taskId="taskbar-task-"+a;this.el=$I(this.id);this.maxButton===!1&&(this.el.find(".win-button-max").remove(),this.el.find(".win-button-max-able").remove());this.el.find(".win-title").text(this.title);this.el.find(".win-top-center").closeSelect();a=this.initPosition;if(this.initPosition===void 0||this.initPosition===null)this.initPosition=a={top:0,left:0};
this.showAt(a.left,a.top);this.setSize(this.width,this.height,!1);this.el.width(1).height(1);this.el.css("visibility","visible");this._show(this._decorate)},setSize:function(a,g,j){var b=!1,f=this.el.find(".win-content").get(0).style,i=this.el.get(0).style;if(typeof a==="number"&&a>0){f.width=a+"px";i.width=a+12+"px";var b=this.el.find(".win-top-center-right").outerWidth(!0),c=this.el.find(".win-icon-wrap").outerWidth(!0);this.el.find(".win-title").get(0).style.width=a-b-c-2+"px";j!==!1&&(this.width=
a);b=!0}if(typeof g==="number"&&g>0)f.height=g+"px",i.height=g+32+"px",j!==!1&&(this.height=g),b=!0;b===!0&&this.onSetSize&&this.onSetSize.call(this,a,g)},showAt:function(a,g){var a=parseInt(a),g=parseInt(g),j=this.el.get(0).style;j.left=a+"px";j.top=g+"px"},_bindEvent:function(){this.draggable=a.draggable({src:"win-title-"+this.number,tar:this.id});if(!c.get("isIE6")&&!c.get("isIE7")&&!c.get("isIE8"))this.draggable.before=function(){this.el.find(".win-content").children().hide()},this.draggable.after=
function(){this.el.find(".win-content").children().show()},this.draggable.scope=this;var b=d.windowmanager.get(this.binding);this.el.mousedown($.proxy(function(){b.frontWindow(this.id)},this));this.el.find(".win-button-close").click($.proxy(function(){b.closeWindow(this.id)},this));this.el.find(".win-button-min").click($.proxy(function(){b.hideWindow(this.id)},this));this.maxButton===!0&&(this.el.find(".win-button-max-able").click($.proxy(function(){b.restoreWindow(this.id)},this)),this.el.find(".win-button-max").click($.proxy(function(){b.maxWindow(this.id)},
this)),this.el.find(".win-title").dblclick($.proxy(function(){this.draggable.isRunning()?b.maxWindow(this.id):b.restoreWindow(this.id)},this)))},_decorate:function(){this.html?(this.setHtml(this.html),delete this.html):$.ajax({context:this,dataType:"html",url:this.url,data:{args:json(this.data)},success:function(a){this.setHtml(a);this.hideMask()},beforeSend:function(){this.showMask()}})},setHtml:function(a,g){h.setTimeout($.proxy(function(){var j=this.el.find(".win-content"),f=j.outerWidth(),i=j.outerHeight(),
f=[{top:0,left:f},{top:0,left:0-f},{top:i,left:0},{top:i,left:f},{top:i,left:0-f},{top:0,left:0}][b.random(5)];j.css("overflowY","hidden").css("position","relative").css("left",f.left+"px").css("top",f.top+"px");j.html(a);this.isAnimate=!0;j.animate({left:0,top:0},c.get("window_speed"),$.proxy(function(){j.css("position","static").css("overflowY","auto");g&&g.call(this);this.onSetHtml&&this.onSetHtml.call(this);this.isAnimate=!1},this))},this),50)},setIndex:function(a){a&&a>0&&(this.index=a);this.el.css("zIndex",
this.index)},animate:function(a,g,j){if(this.isAnimate!==!0){this.isAnimate=!0;j=j||c.get("speed");if(this.animateStep===void 0||this.animateStep===null)this.animateStep=0;this.el.find(".win-title").get(0).style.width="auto";this.el.animate({opacity:a.opacity,top:a.top+"px",left:a.left+"px",width:a.width+"px",height:a.height+"px"},j,$.proxy(function(){this.animateStep++},this));this.el.find(".win-content").animate({width:a.width-12+"px",height:a.height-32+"px"},j,$.proxy(function(){this.animateStep++},
this));var b=function(){this.animateStep===2?(this.animateStep=0,this.isAnimate=!1,g&&g.call(this)):h.setTimeout($.proxy(b,this),50)};h.setTimeout($.proxy(b,this),j)}},savePosition:function(){this.lastPosition=this.el.position()},_max:function(){if(this.isAnimate!==!0){this.savePosition();var a=this.getBindingWindowManager().getBindingDesktop().getSizeWithoutTaskbar();this.animate({opacity:"1",top:0,left:0,width:a.width,height:a.height},function(){this.setSize(a.width-12,a.height-32,!1);this.el.find(".win-button-max").hide();
this.el.find(".win-button-max-able").show();this.draggable.stop();this.status="max";this.onMax&&this.onMax.call(this)})}},_restore:function(){if(this.isAnimate!==!0){var a=this.lastPosition;this.animate({opacity:"1",top:a.top,left:a.left,width:this.width,height:this.height},function(){this.setSize(this.width,this.height);this.el.find(".win-button-max-able").hide();this.el.find(".win-button-max").show();this.draggable.start();this.status="normal";this.onRestore&&this.onRestore.call(this)})}},_show:function(a){if(this.isAnimate!==
!0)if(this.status==="min"){this.setIndex();var g=this.getBindingTaskInfo();this.showAt(g.left,g.top);var j={opacity:"1"},f=this.draggable.isRunning();f?(g=this.lastPosition,d.apply(j,{width:this.width,height:this.height,top:g.top,left:g.left})):(g=this.getBindingWindowManager().getBindingDesktop().getSizeWithoutTaskbar(),d.apply(j,{top:0,left:0,width:g.width,height:g.height}));this.animate(j,function(){f?(this.setSize(j.width,j.height,!1),this.status="normal"):(this.setSize(j.width-12,j.height-32,
!1),this.status="max")},c.get("window_speed"))}else this.status==="normal"&&(this.setIndex(),j={opacity:"1",top:15+b.random(10),left:100+b.random(200),width:this.width,height:this.height},this.animate(j,function(){this.setSize(this.width,this.height);this.status="normal";a&&typeof a==="function"&&a.call(this)},c.get("window_speed")))},_hide:function(){if(this.isAnimate!==!0){this.status==="normal"&&this.savePosition();var a=this.getBindingTaskInfo();this.animate({opacity:"0",top:a.top,left:a.left,
width:a.width,height:a.height},function(){this.index=-1;this.status="min"},c.get("window_speed"))}},close:function(){d.windowmanager.get(this.binding).closeWindow(this.id)},_destory:function(){var a=this.initPosition;this.animate({opacity:"0",top:a.top,left:a.left,width:100,height:50},function(){for(var a=this.items,j=a.length,i=0;i<j;i++){var c=b.getWidght(a[i]);c&&c._destory&&c._destory.call(c)}a=f.windows;j=a.length;for(i=0;i<j;i++)if(c=a[i],this.id===c.id){a.splice(i,1);break}this.draggable.destory();
this.draggable=null;this.el.find(".win-button-close").unbind().remove();this.el.find(".win-button-min").unbind().remove();this.el.find(".win-button-max").unbind().remove();this.el.find(".win-button-max-able").unbind().remove();this.el.find(".win-title").unbind().remove();this.el.unbind().remove();this.el=null;this.onClose&&this.onClose.call(this)},c.get("window_speed"))},addItem:function(a){this.items.push({widgetId:a.id,xtype:a.xtype})},showMask:function(a){var g="win-mask-"+this.number,j="win-overlay-"+
this.number,b=this.el.find("#"+g),f=this.el.find(".win-content");b.length===0&&(b=c.get("mask").replaceAll("{mask-id}",g).replaceAll("{overlay-id}",j),f.before(b),b=this.el.find("#"+g).closeSelect());var g=this.el.find(".mask-overlay"),i=f.innerWidth(),j=f.innerHeight(),f=f.position(),d=g.get(0).style;d.width=i+"px";d.height=j+"px";d.top=f.top+"px";d.left=f.left+"px";g.css("zIndex",this.index).css("opacity",0.7).show();b.find(".mask-content").html(a||"正在加载页面，请稍等...");f=b.outerWidth(!0);a=b.outerHeight(!0);
i=(i-f)/2+13;a=(j-a)/2+33;j=b.get(0).style;j.top=a+"px";j.left=i+"px";b.css("zIndex",this.index+1).show();this.mask=b;this.overlay=g},hideMask:function(a,g){this.mask&&this.mask.fadeOut(0,$.proxy(function(){this.overlay.fadeOut(c.get("speed"),$.proxy(function(){a&&a.call(g||this)},this))},this))},getBindingWindowManager:function(){return d.windowmanager.get(this.binding)},getBindingTaskInfo:function(){var a=d.task.get(this.taskId).el,g=a.offset();return{width:a.outerWidth(!0),height:a.outerHeight(!0),
top:g.top,left:g.left}}};d.addModule("window",{create:function(a){return{widgetId:(new i(a)).id,xtype:"window"}},get:function(a){for(var g=f.windows,b=g.length,i=0;i<b;i++){var c=g[i];if(a===c.id||a==c.number)return c}return null},getAll:function(){return f.windows}})}();
window.athene.windowmanager||function(){var d=window.athene,h=d.util,c=d.window,b={INDEX_STEP:3,windowManagers:[]},a=function(a){this._constructor(a);this._init()};a.prototype={_constructor:function(a){b.windowManagers.push(this);for(var i in a)this[i]=a[i]},_init:function(){this.el=$I(this.id);this.maxIndex=1;this.list=[]},openWindow:function(a){if(!a)throw Error("Window未设置config");if(!a.width)throw Error("Window未设置width");if(!a.height)throw Error("Window未设置height");if(!a.title)throw Error("Window未设置title");
for(var b=this.list,l=b.length,g=0;g<l;g++){var j=c.get(b[g].widgetId);if(j.title===a.title){j.index===-1?this.showWindow(j.id):this.frontWindow(j.id);return}}l=h.getTimestamp();a.number=l;d.taskbar.get(d.desktop.get(this.binding).taskbar.widgetId).appendTask(a);this.increaseMaxIndex();a.index=this.maxIndex;a.binding=this.id;a.data=h.merge({number:l},a.data);b.push(c.create(a))},showWindow:function(a){if((a=c.get(a))&&a.isAnimate===!1&&a.index===-1)this.increaseMaxIndex(),a.index=this.maxIndex,a._show()},
closeWindow:function(a){var b=c.get(a);if(b&&b.isAnimate===!1){for(var l=this.list,g=l.length,j=0;j<g;j++)if(a===l[j].widgetId){l.splice(j,1);break}b._destory();this.reduceMaxIndex();this.setActiveWindow();d.taskbar.get(d.desktop.get(this.binding).taskbar.widgetId).removeTask(b.taskId)}},hideWindow:function(a){if((a=c.get(a))&&a.isAnimate===!1&&a.index!==-1)this.reduceMaxIndex(),a._hide(),this.setActiveWindow()},maxWindow:function(a){var b=c.get(a);b&&b.isAnimate===!1&&(b.index===-1&&this.showWindow(a),
b._max())},restoreWindow:function(a){(a=c.get(a))&&a.isAnimate===!1&&a._restore()},minAllWindow:function(){for(var a=this.list,b=a.length,c=0;c<b;c++)this.hideWindow(a[c].widgetId)},setActiveWindow:function(){var a=d.taskbar.get(d.desktop.get(this.binding).taskbar.widgetId),b=this.getActiveWindow();b?a.setActiveTask(b.taskId):a.setActiveTask(null)},frontWindow:function(a){var i=c.get(a);if(i){i.index===-1&&this.showWindow(a);for(var a=this.list,d=a.length,g=0;g<d;g++){var j=c.get(a[g].widgetId);j.index>
i.index&&j.number!==i.number&&j.setIndex(j.index-b.INDEX_STEP)}i.setIndex(this.maxIndex);this.setActiveWindow()}},getActiveWindow:function(){for(var a=this.maxIndex,b=this.list,d=b.length,g=0;g<d;g++){var j=c.get(b[g].widgetId);if(j&&j.index===a)return j}},increaseMaxIndex:function(){this.maxIndex+=b.INDEX_STEP},reduceMaxIndex:function(){this.maxIndex-=b.INDEX_STEP},getIndexInfo:function(){for(var a=[],b=this.list,d=b.length,g=0;g<d;g++){var j=c.get(b[g].widgetId);a.push("id:"+j.id+"|index:"+j.index)}return a},
getBindingDesktop:function(){return d.desktop.get(this.binding)}};d.addModule("windowmanager",{create:function(b){return{widgetId:(new a(b)).id,xtype:"windowmanager"}},get:function(a){for(var i=b.windowManagers,c=i.length,g=0;g<c;g++){var j=i[g];if(a===j.id||a===j.number)return j}return null},getAll:function(){return b.windowManagers},getFirst:function(){var a=b.windowManagers;return a.length>0?a[0]:null}})}();
window.athene.desktop||function(){var d=window.athene,h=d.util,c=d.taskbar,b=d.dmenubar,a=d.windowmanager,f={desktops:[]},i=function(a){this._constructor(a);this._render()};i.prototype={_constructor:function(a){f.desktops.push(this);this.number="default";for(var g in a)this[g]=a[g]},_render:function(){$("body").append("<div id='desktop-"+this.number+"' class='desktop'><div id='desktop-c-"+this.number+"' class='desktop-c'><div id='desktop-menubar-"+this.number+"'></div><div id='window-manager-"+this.number+
"'></div></div><div id='desktop-t-"+this.number+"' class='desktop-t'></div></div>");this.el=$I("desktop-"+this.number);this.taskbar=c.create({id:"desktop-t-"+this.number,binding:"desktop-"+this.number});this.dmenubar=b.create({id:"desktop-menubar-"+this.number,binding:"desktop-"+this.number});this.windowManager=a.create({id:"window-manager-"+this.number,binding:"desktop-"+this.number});this.id="desktop-"+this.number;delete this.number},setSize:function(a,g){if(typeof a==="number"&&a>0&&typeof g===
"number"&&g>0){var j=this.el.find(".desktop-t").outerHeight(!0),j=g-j;if(j>0){var f=this.el.get(0).style;f.width=a+"px";f.height=g+"px";f=this.el.find(".desktop-c").get(0).style;f.width=a+"px";f.height=j+"px";b.get(this.dmenubar.widgetId).setSize(a,j);f=c.get(this.taskbar.widgetId);f.setSize(a,null);f.setPosition(0,j);this.width=a;this.height=g}}},getDmenubar:function(){return h.getWidght(this.dmenubar)},getTaskbar:function(){return h.getWidght(this.taskbar)},getWindowManager:function(){return d.windowmanager.get(this.windowManager.widgetId)},
getSizeWithoutTaskbar:function(){return{width:this.width,height:this.height-this.el.find(".desktop-t").outerHeight(!0)}}};d.addModule("desktop",{create:function(a){return{widgetId:(new i(a)).id,xtype:"desktop"}},get:function(a){for(var g=f.desktops,b=g.length,i=0;i<b;i++){var c=g[i];if(a===c.id)return c}return null},getAll:function(){return f.desktops}})}();
window.athene.dialog||function(){var d=window.athene,h=window,c=document,b=d.env,a=d.dom,f=d.interaction,i={DIALOG_PREFIX:"dialog-",multiple:2},l=function(a){this._constructor(a);this._render();this._bindEvent()};l.prototype={_constructor:function(a){g.dialogs.push(this);this.width=400;this.cls="dialog-default";d.apply(this,a)},_render:function(){var g=b.get("dialog").replaceAll("{random}",this.number),g=g.replaceAll("{dialogIcon}",this.iconCls);$("body").append(g);this.id=i.DIALOG_PREFIX+this.number;
this.el=$I(this.id);a.addClass(this.el.get(0),this.cls);this.el.find(".dialog-title").html(this.title||"");this.el.find(".dialog-top-center").closeSelect();this._renderType();this.height=this.height||this.el.find(".dialog-content").outerHeight(!0);this._show()},setSize:function(a,g,b){var f=!1,i=this.el.get(0).style,c=this.el.find(".dialog-content").get(0).style;if(typeof a==="number"&&a>0)i.width=a+10+"px",c.width=a+"px",b!==!1&&(this.width=a),f=!0;if(typeof g==="number"&&g>0)c.height=g+"px",i.height=
g+26+5+"px",b!==!1&&(this.height=g),f=!0;f===!0&&this.onSetSize&&this.onSetSize.call(this,a,g)},_renderType:function(){var a=this.el;this.type==="confirm"?a.find(".dialog-content-button-other").remove():a.find(".dialog-content-button-confirm").remove();if(this.type=="alertException"){var g="<textarea readonly='true' class='dialog-content-message-exception'>"+this.message+"</textarea>";a.find(".dialog-content-message-word").html(g)}else a.find(".dialog-content-message-word").html(this.message)},_bindEvent:function(){var a;
this.type==="confirm"?(a=this.el.find(".dialog-button-close"),this.el.find(".dialog-button-ok").click($.proxy(function(){this.close($.proxy(function(){this.callback&&this.callback.call(this.scope||this,!0)},this))},this)),this.el.find(".dialog-button-cancel").click($.proxy(function(){this.close($.proxy(function(){this.callback&&this.callback.call(this.scope||this,!1)},this))},this))):a=this.el.find(".dialog-button-close,.dialog-button-ok");a.click($.proxy(function(){this.close()},this));this.draggable=
f.draggable({src:"dialog-icon-title-"+this.number,tar:this.id})},showAt:function(a,g){var a=parseInt(a),g=parseInt(g),b=this.el.get(0).style;b.left=a+"px";b.top=g+"px"},_initPosition:function(){var a=$(c),g=d.core.getActiveWindowSize(),b=a.scrollTop(),a=a.scrollLeft(),f={};f.leftInit=(g.width-(this.width+10)*i.multiple)/2+a;f.topInit=(g.height-(this.height+26+5)*i.multiple)/2+b;f.left=(g.width-(this.width+10))/2+a;f.top=(g.height-(this.height+26+5))/2+b;this.position=f},_show:function(){this._initPosition();
var a=this.position;this.showAt(a.leftInit,a.topInit);this.setSize(this.width*i.multiple,this.height*i.multiple,!1);this.el.css("visibility","visible").css("fontSize","24px").css("zIndex",20001).css("opacity",0).show();this._showOverlay();this.animate({opacity:1,width:this.width,height:this.height,fontSize:12,top:a.top,left:a.left},function(){this.el.find(".dialog-title").width(this.width-44-16-4)})},animate:function(a,g,f){if(this.isAnimate!==!0){this.isAnimate=!0;f=f||b.get("speed");if(this.animateStep===
void 0||this.animateStep===null)this.animateStep=0;this.el.animate({opacity:a.opacity,top:a.top+"px",left:a.left+"px",fontSize:a.fontSize+"px",width:a.width+10+"px",height:a.height+26+5+"px"},f,$.proxy(function(){this.animateStep++},this));this.el.find(".dialog-content").animate({width:a.width+"px",height:a.height+"px"},f,$.proxy(function(){this.animateStep++},this));var i=function(){this.animateStep===2?(this.animateStep=0,this.isAnimate=!1,g&&g.call(this)):h.setTimeout($.proxy(i,this),50)};h.setTimeout($.proxy(i,
this),f)}},_showOverlay:function(){this.beforeShowOverlay&&this.beforeShowOverlay.call(this);var a=d.core.getActiveWindowSize();$("body").append("<div id='dialog-mask-overlay' class='mask-overlay' style='width:"+a.width+"px;height:"+a.height+"px;top:0px;left:0px;z-index:20000;overflow:hidden;opacity:0;'/>");$I("dialog-mask-overlay").show().animate({opacity:0.7},b.get("speed"))},_closeOverlay:function(){var a=$I("dialog-mask-overlay");a.fadeOut(b.get("speed"),$.proxy(function(){a.remove();this.onCloseOverlay&&
this.onCloseOverlay.call(this)},this))},close:function(a){var b=this.position,b={opacity:0,width:this.width*i.multiple,height:this.height*i.multiple,fontSize:24,top:b.topInit,left:b.leftInit};this._closeOverlay();this.animate(b,function(){for(var b=g.dialogs,f=b.length,i=0;i<f;i++)if(this.id==b[i].id){b.splice(i,1);break}this.draggable.destory();this.draggable=null;this.el.find(".dialog-button-close").unbind().remove();this.el.find(".dialog-button-ok").unbind().remove();this.el.find(".dialog-button-cancel").unbind().remove();
this.el.unbind().remove();this.el=null;h.setTimeout($.proxy(function(){a&&a();this.scope=null},this),100)})}};var g={dialogs:[],openDialog:function(a){var b=g.dialogs;b.length>0?b[0].close(function(){new l(a)}):new l(a)}};d.addModule("dialog",{alert:function(a){a&&(a={message:a,number:d.util.getTimestamp(),type:"alert",iconCls:"dialog-icon-alert"},g.openDialog(a))},alertException:function(a){a&&(a={width:650,message:a,number:d.util.getTimestamp(),type:"alertException",iconCls:"dialog-icon-error"},
g.openDialog(a))},warning:function(a){a&&(a={message:a,number:d.util.getTimestamp(),type:"alert",iconCls:"dialog-icon-warning"},g.openDialog(a))},error:function(a){a&&(a={message:a,number:d.util.getTimestamp(),type:"alert",iconCls:"dialog-icon-error"},g.openDialog(a))},ok:function(a){a&&(a={message:a,number:d.util.getTimestamp(),type:"alert",iconCls:"dialog-icon-ok"},g.openDialog(a))},confirm:function(a,b,f,i){if(a&&b)a={message:a,scope:f,callback:b,number:d.util.getTimestamp(),type:"confirm",iconCls:"dialog-icon-confirm"},
i&&(a.width=i),g.openDialog(a)}})}();
window.athene.grid||function(){var d=window.athene,h=document,c=d.dom,b=d.env,a=d.util,f={grids:[]},i=function(a){this._constructor(a);this._init();this._render()},l={_constructor:function(a){f.grids.push(this);this.cellPL=5;this.cellPR=3;this.cellBRW=1;this.cellMoveW=10;this.items=[];this.totalCount=0;this.changed=!1;this.paramMap=void 0;this.defaultMap={};this.showMask=!0;this.selectItems=[];d.apply(this,a)},_init:function(){this.xtype="grid";this.el=$I(this.id);e=this.el.get(0);c.addClass(e,"grid-default");
this.gridCls&&c.addClass(e,this.gridCls);this.width=this.width||this.el.parent().innerWidth();this.borderLW=a.fetchNumber(this.el.css("borderLeftWidth"));this.borderRW=a.fetchNumber(this.el.css("borderRightWidth"));d.window.get(this.binding).addItem(this);this.onInit&&this.onInit.call(this)},_render:function(){var a=this.width-this.borderLW-this.borderRW;this.el.empty().append("<div class='grid-head'></div><div class='grid-body'></div><div class='grid-page'></div>");this.headEl=this.el.children(".grid-head");
this.bodyEl=this.el.children(".grid-body");this.pageEl=this.el.children(".grid-page");this.el.get(0).style.width=a+"px";this.headEl.get(0).style.width=a+"px";this.bodyEl.get(0).style.width=a+"px";this.pageEl.get(0).style.width=a+"px";this._renderHead();this.clearBody();this.pagination===!0&&this._renderPagination();this._bindEvent();this.onRender&&this.onRender.call(this);this.items.length>0&&this._decorate()},_renderHead:function(){var a=this.cellPL+this.cellPR,b=[],f=this.colModels,i=f.length,c=
this.width-this.borderLW-this.borderRW,d=c,l=this.cellMoveW;b.push("<table cellpadding='0' cellspacing='0'><thead>");this.hasRowNumber===!0&&(b.push("<th style='border-right: 1px solid #d0d0d0;'><div class='grid-cell grid-row-number'></div></th>"),d-=30);this.selectModel==="multiSelect"?(b.push("<th style='border-right: 1px solid #d0d0d0;'><div class='grid-checkbox-wrap'>"),b.push("<span class='grid-checkbox' style='display:none;' buz_type='all' buz_status='unchecked'>"),b.push("</span></div></th>"),
d-=22):this.selectModel==="singleSelect"&&(b.push("<th style='border-right: 1px solid #d0d0d0;'><div class='grid-radio-wrap'></div></th>"),d-=22);for(var h=0;h<i;h++){var m=f[h];m.width=m.width||100;var p=m.width,s=m.title,q=0;if(!1!==m.hasTips&&(m.formatter===void 0||m.formatter===null))m.hasTips=!0;if(!1!==m.resizeable)m.resizeable=!0;b.push("<th>");if(this.percent===!0)h+1<i?(p=parseInt(p*c),m.widthPx=p,d-=p):(p=d,m.widthPx=p,d=0),p=m.widthPx;q=p-a;b.push("<div class='grid-title-inner' biz_index='"+
h+"' style='width:"+p+"px;'>");b.push("<div class='grid-cell' style='width:"+(q-l)+"px;'");s&&m.hasTips===!0&&b.push(" title='"+s+"'");b.push(">");b.push(s||"");b.push("</div>");m.resizeable===!0?b.push("<div class='grid-cell-move-right'></div>"):b.push("<div class='grid-cell-static-right'></div>");b.push("</div></th>")}b.push("</thead></table>");this.headEl.html(b.join(""))},_bindEvent:function(){this.el.bind({mouseover:function(a){var b=a.target;b.nodeName==="A"&&(c.addClass(b,"link-hover"),a.stopPropagation())},
mouseout:function(a){var b=a.target;b.nodeName==="A"&&(c.removeClass(b,"link-hover"),a.stopPropagation())}});this.bodyEl.scroll($.proxy(function(){this.headEl.scrollLeft(this.bodyEl.scrollLeft())},this));this.selectModel==="multiSelect"&&this.el.click($.proxy(function(a){var a=a.target,b=a.className,f=a.nodeName;if(b.contains("checkbox")&&f==="SPAN")if(a.getAttribute("buz_type")==="all")for(var b=this.items,f=b.length,a=a.getAttribute("buz_status"),i=0;i<f;i++)a==="checked"?this.removeSelectRow(b[i],
null,!1):this.addSelectRow(b[i],null,!1),this._triggerCheckAll.call(this);else b=a.getAttribute("buz_status"),b==="unchecked"?(b=this.getItemByDom(a))&&this.addSelectRow(b,$(a)):(b=this.getItemByDom(a))&&this.removeSelectRow(b,$(a));else if(b.indexOf("grid-cell")!==-1&&f==="DIV"&&(a=$(a).parents("tr"),a.length>0&&(b=a.get(0).className,b.contains("grid-tr-odd")||b.contains("grid-tr-even"))))if(a=a.children("td.grid-checkbox-td").find(".grid-checkbox"),f=a.get(0),b=f.getAttribute("buz_status"))b===
"unchecked"?(b=this.getItemByDom(f))&&this.addSelectRow(b,a,!0):(b=this.getItemByDom(f))&&this.removeSelectRow(b,a,!0)},this));this.headEl.mousedown($.proxy(function(a){var f=a.target;if(f.className==="grid-cell-move-right"){var i=$(h),c=$("body"),d=$(f),f=d.parent("div.grid-title-inner").attr("biz_index"),d=d.offset(),l=this.headEl.outerHeight()+this.bodyEl.innerHeight();c.css("cursor","col-resize").append("<div id='grid-move-proxy' biz_index='"+f+"' style='height:"+l+"px;left:"+a.pageX+"px;top:"+
d.top+"px;'></div>");c.closeSelect();i.mousemove(this._moveColumn);i.one("mouseup",$.proxy(this._resetColumn,this));b.set("gridMoveProxy",$I("grid-move-proxy"));b.set("gridMousePos",{pageX:a.pageX});b.set("gridMousePosInit",{pageX:a.pageX})}},this))},_resetColumn:function(){var a=b.get("gridMoveProxy"),f=a.attr("biz_index"),i=this.colModels[f];colWidth=this.percent===!0?i.widthPx:i.width;var c=b.get("gridMousePos"),d=b.get("gridMousePosInit"),i=$(h),c=colWidth+(c.pageX-d.pageX);c>20&&(this.setColumnWidth(f,
c),this._adjustHead());$("body").css("cursor","default").openSelect();a.remove();i.unbind("mousemove",this._moveColumn);b.set("gridMoveProxy",null);b.set("gridMousePos",null);b.set("gridMousePosInit",null)},_moveColumn:function(a){var f=b.get("gridMoveProxy"),i=b.get("gridMousePos");if(f&&i){var c=a.pageX-i.pageX,c=f.position().left+c;f.get(0).style.left=c+"px";i.pageX=a.pageX;a.stopPropagation()}},setColumnWidth:function(a,b){var f=this.colModels,a=parseInt(a);if((f=f[a])&&b&&!(b<20)){this.percent===
!0?f.widthPx=b:f.width=b;var f=this.cellPL+this.cellPR,i=this.cellBRW,c=this.cellMoveW,d=this.headEl.children("table").find("div[biz_index='"+a+"']"),l=d.children("div.grid-cell");d.find(".grid-cell-move-right").length>0&&(d.width(b),l.width(b-f-c));c=this.bodyEl.find(".empty-div");c.length>0?(f=this.headEl.children("table").outerWidth(),c.width(f)):this.bodyEl.children("table").find("div[biz_index='"+a+"']").width(b-f-i)}},_decorate:function(){this._decorateRows();this.pagination===!0&&this._resetPagination();
this._adjustHead()},clearBody:function(){this.bodyEl.html("<div class='empty-div' style='width:"+this.headEl.children("table").outerWidth()+"px;'/>")},_adjustHead:function(){var a=this.bodyEl.get(0),b=a.offsetWidth-a.clientWidth,a=a.offsetHeight-a.clientHeight,f=this.headEl.children("table").find("tr:first");f.children(".grid-head-filler-wrap").remove();b>0&&a>0&&f.append("<th class='grid-head-filler-wrap'><div class='grid-head-filler' style='width:"+b+"px;'></div></th>")},_isChecked:function(a){if(this.selectModel===
"multiSelect")for(var b=this._getValueField,f=this.selectItems,i=f.length,c=0;c<i;c++){var d=f[c];if(b.call(this,d)===b.call(this,a))return!0}else if(this.selectModel==="singleSelect"&&(d=this.selectItem))if(b=this._getValueField,b.call(this,d)===b.call(this,a))return!0;return!1},_getValueField:function(a){if(!(a===void 0||a===null)){var b=this.formatValueField;return b?b.call(this,a):a[this.valueField]}},_decorateRows:function(){var a=[],b=this.items,f=b.length,i=this.colModels,c=i.length,d=this.selectModel===
"multiSelect",l=this.selectModel==="singleSelect",h=this.cellPL+this.cellPR+this.cellBRW,m=this._getValueField;a.push("<table cellpadding='0' cellspacing='0'><tbody>");for(var p=0;p<f;p++){var s=b[p],q=(p+1)%2,r=m.call(this,s);a.push("<tr");a.push(q<1?" class='grid-tr-even":" class='grid-tr-odd");q=!1;if(d||l)q=this._isChecked(s);d&&q&&a.push(" grid-tr-checked");a.push("'>");this.hasRowNumber===!0&&(a.push("<td>"),a.push("<div class='grid-cell grid-row-number'>"),a.push(p+1),a.push("</div></td>"));
d?(a.push("<td class='grid-checkbox-td'><div class='grid-checkbox-wrap'>"),q===!0?(a.push("<span class='grid-checkbox grid-checkbox-checked' buz_type='single'"),a.push(" buz_value='"+r+"' buz_status='checked'>")):(a.push("<span class='grid-checkbox' buz_type='single'"),a.push(" buz_value='"+r+"' buz_status='unchecked'>")),a.push("</span></div></td>")):l&&(a.push("<td class='grid-radio-td'><div class='grid-radio-wrap'>"),q===!0?(a.push("<span class='grid-radio grid-radio-checked' buz_type='single'"),
a.push(" buz_value='"+r+"' buz_status='checked'>")):(a.push("<span class='grid-radio' buz_type='single'"),a.push(" buz_value='"+r+"' buz_status='unchecked'>")),a.push("</span></div></td>"));for(q=0;q<c;q++){a.push("<td>");var y=i[q],z=y.width,r=s[y.key];y.formatter&&(r=y.formatter(r,s,p,q));r=r!==void 0&&r!==null?r+"":"";if(this.percent===!0)z=y.widthPx;a.push("<div class='grid-cell' biz_index='"+q+"' style='width:"+(z-h)+"px;'");r&&y.hasTips===!0&&a.push(" title='"+r+"'");a.push(">");a.push(r);a.push("</div></td>")}a.push("</tr>")}a.push("</tbody></table>");
this.bodyEl.html(a.join(""));d&&this._triggerCheckAll.call(this)},_destory:function(){for(var a=f.grids,b=a.length,i=0;i<b;i++)if(this.id==a[i].id){a.splice(i,1);break}this.pageEl.find(".page-size").unbind().remove();this.pageEl.unbind().remove();this.bodyEl.unbind().remove();this.headEl.unbind().remove();this.el.unbind().remove()},getBindingWindow:function(){return d.window.get(this.binding)},setSize:function(a,b){var f=!1;if(a&&typeof a==="number"&&a>0&&a>0){var i=a-this.borderLW-this.borderRW;
if(i>0){this.width=a;this.el.get(0).style.width=i+"px";this.headEl.get(0).style.width=i+"px";this.bodyEl.get(0).style.width=i+"px";this.pageEl.get(0).style.width=i+"px";if(this.percent===!0){var f=this.width,i=this.colModels,c=i.length;this.hasRowNumber===!0&&(f-=30);if(this.selectModel==="multiSelect"||this.selectModel==="singleSelect")f-=22;for(var d=0;d<c;d++){var l=i[d],h=l.width;d+1<c?(h=parseInt(h*f),l.widthPx=h,f-=h):(h=f,l.widthPx=h,f=0);this.setColumnWidth(d,h)}}f=!0}}if(b&&typeof b==="number"&&
b>=0&&b>0&&(i=this.headEl.outerHeight(),c=this.pageEl.outerHeight(),i=b-i-c,b>0&&i>0))this.height=b,this.el.get(0).style.height=b+"px",this.bodyEl.get(0).style.height=i+"px",f=!0;f===!0&&this._adjustHead()}};d.apply(l,{_excute:function(a){var b={query:!0,args:json(this.paramMap)};if(this.pagination)b.pageSize=this.pageSize,b.curPage=a.curPage;$.ajax({url:this.url,data:b,dataType:"json",context:this,beforeSend:function(){this.getBindingWindow().showMask("正在加载数据，请稍等...")},success:function(a){if(a.returnCode===
3)athene.dialog.alertException(a.exceptionDesc);else{if(a&&typeof a==="object")for(var b in a)this[b]=a[b];this._decorate.call(this,a);this.onQuery&&this.onQuery.call(this,a);this.getBindingWindow().hideMask()}}})},query:function(a){this.paramMap=d.util.merge(this.defaultMap,a);this._excute({curPage:1})},first:function(){this._excute({curPage:1})},last:function(){this._excute({curPage:this.totalPage})},next:function(){this._excute({curPage:this.curPage+1})},previous:function(){this._excute({curPage:this.curPage-
1})},refresh:function(){this.curPage!==void 0&&this._excute({curPage:this.curPage})},refreshSubmit:function(){if(this.submit===!0&&b.get("refreshSubmit")===!0)this.refresh(),this.submit=!1},setPageSize:function(a){if(a)this.pageSize=a,this.curPage!==void 0&&this.first()}});d.apply(l,{getSelectRow:function(){},getSelectRows:function(){return this.selectItems},getItemByDom:function(a){return(a=a.getAttribute("buz_value"))?this.getItem(a):null},getItem:function(a){var b=this.items,f=b.length;if(a==void 0||
f==0)return null;for(var i=this._getValueField,c=0;c<f;c++){var d=b[c];if(i.call(this,d)==a)return d}return null},addRow:function(a){if(!(this.pagination||typeof a!=="object"))return this.items.push(a),this.totalCount++,this.changed=!0,this._decorateRows(),this},replaceRow:function(a,b){if(!(this.pagination||typeof b!=="object")&&!(a>=this.items.length))return this.items.splice(a,1,b),this.changed=!0,this._decorateRows(),this},removeRow:function(a){if(!(this.pagination||typeof a!=="number")&&!(a>=
this.items.length))return this.items.splice(a,1),this.totalCount--,this.changed=!0,this._decorateRows(),this},clearSelectRows:function(){this.selectItems=[];this._decorateRows();this.onClearSelectRows&&this.onClearSelectRows.call(this)},removeSelectRow:function(a,b,f){var i=void 0,d=this.valueField,l=this.selectItems,h=l.length;if(a&&h>0)for(var n=0;n<h;n++){var m=l[n];if(a[d]===m[d]){i=m;l.splice(n,1);a=b||this.bodyEl.find("span[buz_value='"+m[d]+"']");a.length>0&&(this._triggerRow(a,!1),c.removeClass(a.get(0),
"grid-checkbox-checked"),a.attr("buz_status","unchecked"));break}}this.onRemoveSelectRow&&i&&(f===!1||this._triggerCheckAll.call(this),this.onRemoveSelectRow.call(this,i));return this},_triggerRow:function(a,b){if(a&&a.length>0){var f=a.parents("tr");f.length>0&&(b===!0?c.addClass(f.get(0),"grid-tr-checked"):c.removeClass(f.get(0),"grid-tr-checked"))}},addSelectRow:function(a,b,f){a&&(b=b||this.bodyEl.find("span[buz_value='"+a[this.valueField]+"']"),b.length>0&&(this._triggerRow(b,!0),b.attr("buz_status")===
"unchecked"&&(c.addClass(b.get(0),"grid-checkbox-checked"),b.attr("buz_status","checked"),this.selectItems.push(a),f===!1||this._triggerCheckAll.call(this),this.onAddSelectRow&&this.onAddSelectRow.call(this,a))));return this},_triggerCheckAll:function(){if(this.selectModel==="multiSelect"){var a=this.headEl.find(".grid-checkbox");this.items.length>0?(a.show(),this.bodyEl.find(".grid-checkbox[buz_status='unchecked']").length===0?(a.attr("buz_status","checked"),c.addClass(a.get(0),"grid-checkbox-checked")):
(a.attr("buz_status","unchecked"),c.removeClass(a.get(0),"grid-checkbox-checked"))):(a.attr("buz_status","unchecked"),a.hide())}},setSelectRows:function(a){if(a instanceof Array){this.selectItems=[];for(var b=a.length,f=0;f<b;f++)this.selectItems.push(a[f])}return this}});d.apply(l,{_renderPagination:function(){var a=[];a.push("<div class='grid-page-bg'><span style='float:left;'><table cellpadding='0' cellspacing='0' border='0'><tbody><tr>");a.push("<td><span class='grid-page-button grid-page-first-disabled' buz_type='first' buz_status='disable'></span></td>");
a.push("<td><span class='grid-page-button grid-page-prev-disabled' buz_type='prev' buz_status='disable'></span></td>");a.push("<td><span class='grid-page-split'></span></td>");a.push("<td><span class='grid-page-content'>第</span>");a.push("<span class='cur-page grid-page-number'>0</span>");a.push("<span class='grid-page-content'>页</span></td>");a.push("<td style='padding-left:4px;'><span class='grid-page-content'>共</span>");a.push("<span class='total-page grid-page-number'>0</span>");a.push("<span class='grid-page-content'>页</span></td>");
a.push("<td><span class='grid-page-split'></span></td>");a.push("<td><span class='grid-page-button grid-page-next-disabled' buz_type='next' buz_status='disable'></span></td>");a.push("<td><span class='grid-page-button grid-page-last-disabled' buz_type='last' buz_status='disable'></span></td>");a.push("<td><span class='grid-page-split'></span></td>");a.push("<td><span class='grid-page-button grid-page-refresh-disabled' buz_type='refresh' buz_status='disable'></span></td>");a.push("<td><span class='grid-page-split'></span></td>");
a.push("<td><span class='page-size-wrap'><select class='page-size'><option value='10'>10</option>");a.push("<option value='20'>20</option><option value='30'>30</option><option value='40'>40</option>");a.push("<option value='50'>50</option></select></span></td></tr></tbody></table></span>");a.push("<span style='float:right;'><table cellpadding='0' cellspacing='0' border='0'><tbody><tr>");a.push("<td><span class='total-count'>没有数据需要显示</span></td></tr></tbody></table></span>");a.push("<span style='clear:both;'></span>");
a.push("</div>");this.pageEl.html(a.join(""));this._bindPaginationEvent()},_bindPaginationEvent:function(){this.pageEl.bind({click:$.proxy(function(a){var b=a.target,f=b.getAttribute("buz_type"),b=b.getAttribute("buz_status");f&&b==="enable"&&(f==="first"?this.first():f==="prev"?this.previous():f==="next"?this.next():f==="last"?this.last():f==="refresh"&&this.refresh(),a.stopPropagation())},this),mousemove:function(a){var b=a.target,f=b.getAttribute("buz_type"),i=b.getAttribute("buz_status");f&&i===
"enable"&&(c.replaceClass(b,"grid-page-button grid-page-"+f+"-hover"),a.stopPropagation())},mouseout:function(a){var b=a.target,f=b.getAttribute("buz_type"),i=b.getAttribute("buz_status");f&&i==="enable"&&(c.replaceClass(b,"grid-page-button grid-page-"+f),a.stopPropagation())},mousedown:function(a){var b=a.target,f=b.getAttribute("buz_type"),i=b.getAttribute("buz_status");f&&i==="enable"&&(c.addClass(b,"grid-page-button grid-page-"+f+"-active"),a.stopPropagation())},mouseup:function(a){var b=a.target,
f=b.getAttribute("buz_type"),i=b.getAttribute("buz_status");f&&i==="enable"&&(c.removeClass(b,"grid-page-button grid-page-"+f+"-active"),a.stopPropagation())}});this.pageEl.find(".page-size").change($.proxy(function(){var a=this.pageEl.find(".page-size").val();this.setPageSize(parseInt(a))},this))},_resetPagination:function(){var a=this.pageEl,b=a.find("span[buz_type='first']"),f=a.find("span[buz_type='prev']"),i=a.find("span[buz_type='next']"),c=a.find("span[buz_type='last']"),d=a.find("span[buz_type='refresh']"),
l=a.find("span.cur-page"),h=a.find("span.total-page"),a=a.find("span.total-count");this.curPage&&this.totalCount?(this._enableButton(d),l.html(this.curPage),h.html(this.totalPage),a.html("共找到"+this.totalCount+"条记录"),this.curPage<2?(this._disableButton(b),this._disableButton(f)):(this._enableButton(b),this._enableButton(f)),this.curPage>=this.totalPage?(this._disableButton(i),this._disableButton(c)):(this._enableButton(i),this._enableButton(c))):(this._disableButton(b),this._disableButton(f),this._disableButton(i),
this._disableButton(c),this._disableButton(d),l.html("0"),h.html("0"),a.html("没有数据需要显示"))},_enableButton:function(a){if(a.attr("buz_status")==="disable"){var b=a.attr("buz_type");c.replaceClass(a.get(0),"grid-page-button grid-page-"+b);a.attr("buz_status","enable")}},_disableButton:function(a){if(a.attr("buz_status")==="enable"){var b=a.attr("buz_type");c.replaceClass(a.get(0),"grid-page-button grid-page-"+b+"-disabled");a.attr("buz_status","disable")}}});i.prototype=l;d.addModule("grid",{getAll:function(){return f.grids},
get:function(a){for(var b=f.grids,i=b.length,c=0;c<i;c++){var d=b[c];if(a==d.id)return d}return null},create:function(a){return{widgetId:(new i(a)).id,xtype:"grid"}}})}();
window.athene.log||function(){var d=window.athene,h=d.core.$I,c=window,b=document,a={inited:!1,logable:!1,debugable:!1,infoable:!1},f={_getTime:function(){var a=new Date,b=a.getMonth()+1;return a.getFullYear()+"-"+b+"-"+a.getDate()+"&nbsp;"+a.toLocaleTimeString()+"&nbsp&nbsp;"},_print:function(b){var c;switch(typeof b.content){case "object":c=$.toJSON(b.content);break;default:c=b.content}var d=f._getTime()+b.tag+"&nbsp&nbsp;";a.console.append('<div class="log-content"><span style="color:'+b.color+
';">'+d+"</span>"+c+"</div>").scrollTop(99999999)}},b={LEVEL:{DEBUG:"debug",INFO:"info",ERROR:"error"},init:function(b,f){if(b&&!a.inited){if(b=="debug")a.logable=!0,a.debugable=!0,a.infoable=!0;else if(b=="info")a.logable=!0,a.infoable=!0;else if(b=="error")a.logable=!0;else return;d.window.open({title:"日志控制台",width:500,height:400,content:d.env.get("logConsole")});a.inited=!0;a.console=h("log-console");c.log=this;f&&f.call(this)}},debug:function(b){a.logable&&a.debugable&&f._print({tag:"DEBUG",color:"blue",
content:b})},info:function(b){a.logable&&a.infoable&&f._print({tag:"INFO",color:"black",content:b})},error:function(b){a.logable&&f._print({tag:"ERROR",color:"red",content:b})},clear:function(){a.console&&a.console.empty()}};d.addModule("log",b)}();
window.athene.form||function(){var d=window.athene,h={forms:[]},c=function(b){this._constructor(b);this._init()};c.prototype={_constructor:function(b){h.forms.push(this);for(var a in b)this[a]=b[a]},_init:function(){d.window.get(this.binding).addItem(this)},getRow:function(){if(!this.items)throw Error("数组定义有错误");for(var b=$I(this.id),a={},f=this.items,i=f.length,c=0;c<i;c++){var g=f[c],j=g.type;if(j==="Grid"){if((j=d.grid.get(g.id))&&j.name&&j.items.length>0)g=j.name,a[g]=j.items,a[g+"Changed"]=j.changed}else if(j===
"ListField"){if((j=d.listfield.get(g.id))&&j.name&&j.items.length>0)g=j.name,a[g]=j.items,a[g+"Changed"]=j.changed}else if(j==="CheckGroup"){if((j=d.checkgroup.get(g.id))&&j.name&&j.selectItems.length>0)g=j.name,a[g]=j.selectItems,a[g+"Changed"]=j.changed}else if(g=b.find("#"+g.id),g.length>0&&(g=g.get(0))&&g.name&&g.value)a[g.name]=g.value}return a},getConfirmRow:function(){if(!this.items)throw Error("数组定义有错误");for(var b=$I(this.id),a=[],f=this.items,i=f.length,c=0;c<i;c++){var g=f[c],j=g.type;if(g.label&&
j)if(j==="Grid"){if((j=d.grid.get(g.id))&&j.name&&j.items.length>0){a.push("<div class='fwb form-label'>"+g.label+"：</div>");for(var h=j.items,t=h.length,g=0;g<t;g++){a.push("<div class='ti2'>");for(var u=h[g],x=j.colModels,v=x.length,n=0;n<v;n++){var m=x[n].key;m&&u[m]&&a.push(u[m]+" ")}a.push("</div>")}}}else if(j==="CheckGroup"){if((j=d.checkgroup.get(g.id))&&j.name&&j.selectItems.length>0){h=j.selectItems;t=h.length;a.push("<div class='fwb form-label'>"+g.label+"：</div>");a.push("<div class='ti2'>");
for(g=0;g<t;g++)a.push(h[g][j.listKey]+" "),(g+1)%5===0&&g+1!==t&&a.push("</div><div class='ti2'>");a.push("</div>")}}else if(j==="ListField"){if((h=d.listfield.get(g.id))&&h.name&&h.items.length>0){j=h.listKey;h=h.items;t=h.length;a.push("<div class='fwb form-label'>"+g.label+"：</div>");a.push("<div class='ti2'>");for(g=0;g<t;g++)a.push(h[g][j]+" "),(g+1)%5===0&&g+1!==t&&a.push("</div><div class='ti2'>");a.push("</div>")}}else if(j==="ComboBox"){if(j=b.find("#"+g.id),j.length>0&&(h=j.get(0))&&h.name&&
h.value)j=j.children("option[value='"+h.value+"']"),a.push("<div><span class='fwb form-label'>"+g.label+"：</span>"),a.push("<span>"+j.text()+"</span></div>")}else if(j=b.find("#"+g.id),j.length>0&&(h=j.get(0))&&h.name&&h.value)a.push("<div><span class='fwb form-label'>"+g.label+"：</span>"),a.push("<span>"+h.value+"</span></div>")}return a.join("")},save:function(){this.handler("saveUrl","messageSave","onSave")},update:function(){this.handler("updateUrl","messageUpdate","onUpdate")},remove:function(){this.handler("removeUrl",
"messageRemove","onRemove")},handler:function(b,a,f){if(!b||!this[b])throw Error("url未定义");var i=$I(this.id),c=this[b],g=this.getRow(),b=this.getConfirmRow(),j={number:this.binding,args:json(g)},h=function(a){a!==!1&&$.ajax({url:c,context:this,data:j,beforeSend:function(){i.find(".fm-error").hide().find(".fm-error-content").empty();this.getBindingWindow().showMask("正在提交数据，请稍等...")},dataType:"json",success:function(a){if(a.returnCode===0){this.onSuccess&&this.onSuccess.call(this,a);var b=this[f];b&&
typeof b==="function"&&b.call(this,g,a)}else if(a.returnCode===1)for(var a=a.validationErrors,b=a.length,c=0;c<b;c++){var j=a[c];i.find("#"+j.id).show().find(".fm-error-content").html(j.message)}else a.returnCode===4||a.returnCode===2?d.dialog.error(a.exceptionDesc):d.dialog.alertException(a.exceptionDesc)},complete:function(){this.getBindingWindow().hideMask()}})};a&&this[a]?d.dialog.confirm(this[a](b,g),h,this,this.dialogWidth):h.call(this)},getBindingWindow:function(){return d.window.get(this.binding)},
_destory:function(){for(var b=h.forms,a=b.length,f=0;f<a;f++)this.id===b[f].id&&b.splice(f,1)}};d.addModule("form",{create:function(b){return{widgetId:(new c(b)).id,xtype:"form"}},get:function(b){for(var a=h.forms,f=a.length,c=0;c<f;c++){var d=a[c];if(b===d.id)return d}return null},getAll:function(){return h.forms}})}();
window.athene.listfield||function(){var d=window.athene,h={listFields:[]},c=function(b){this._constructor(b);this._init();this._render();this._bindEvent()};c.prototype={_constructor:function(b){if(!b.id)throw Error("ListField控件必须设置id");if(!b.binding)throw Error("ListField控件必须设置binding");if(!b.listKey)throw Error("ListField控件必须设置listKey");if(!b.listValue)throw Error("ListField控件必须设置listValue");h.listFields.push(this);this.items=[];this.removeable=!0;this.contentWidth=66;for(var a in b)this[a]=b[a]},
_init:function(){this.xtype="listfield";this.changed=!1;this.el=$I(this.id);d.window.get(this.binding).addItem(this)},_render:function(){var b=[];b.push("<fieldset class='listfield-default'><legend>");b.push(this.title||"");b.push("</legend><div class='listfield-wrap'><div class='clear'></div></div></fieldset>");this.el.append(b.join(""));this.items.length>0&&this._renderItems()},_bindEvent:function(){this.el.find(".listfield-wrap").click($.proxy(function(b){b=b.target;b.className.contains("icon-remove")&&
this.removeItem(b.getAttribute("biz_value"))},this))},_renderItems:function(){for(var b=[],a=this.items,f=a.length,c=0;c<f;c++)b.push(this._generateItem(c,a[c]));b.push("<div class='clear'></div>");this.el.children("fieldset").children("div").html(b.join(""))},_generateItem:function(b,a){var f=[];f.push("<div class='listfield-item'>");f.push("<div class='listfield-item-content' style='width:"+this.contentWidth+"px;'>");this.formatter?f.push(this.formatter.call(this,b,a)||""):f.push(a[this.listKey]||
"");f.push("</div>");if(this.removeable===!0){var c=a[this.listValue];f.push("<div class='listfield-item-icon-wrap'><div class='listfield-item-icon icon-remove cp'");f.push(" biz_value='"+c+"'/></div></div>")}f.push("</div>");return f.join("")},setItems:function(b){if(b instanceof Array&&b.length>0){var a=b.length;this.items=[];for(var f=0;f<a;f++)this.items.push(b[f]);this._renderItems();this.changed=!0;this.onSetItems&&this.onSetItems.call(this,b)}return this},getItems:function(){return this.items},
clearItems:function(){if(this.items.length>0)this.items=[],this._renderItems(),this.changed=!0,this.onClearItems&&this.onClearItems.call(this);return this},addItem:function(b){if(b){for(var a=this.listValue,f=this.items,c=f.length,d=0;d<c;d++)if(f[d][a]===b[a])return;f.push(b);a=this._generateItem(c,b);this.el.find(".listfield-wrap").children(".clear").before(a);this.changed=!0;this.onAddItem&&this.onAddItem.call(this,b)}return this},removeItem:function(b){if(b==void 0||this.items.length==0)return this;
for(var a=void 0,f=this.listValue,c=this.items,d=c.length,g=0;g<d;g++){var j=c[g];if(typeof b==="object"){if(j[f]===b[f]){a=j;c.splice(g,1);break}}else if(j[f]==b){a=j;c.splice(g,1);break}}if(a)this._renderItems(),this.changed=!0,this.onRemoveItem&&this.onRemoveItem.call(this,a);return this},_destory:function(){for(var b=h.listFields,a=b.length,f=0;f<a;f++)if(this.id===b[f].id){b.splice(f,1);break}this.el.find(".listfield-wrap").unbind();this.el.remove()}};d.addModule("listfield",{create:function(b){return{widgetId:(new c(b)).id,
xtype:"listfield"}},get:function(b){for(var a=h.listFields,f=a.length,c=0;c<f;c++){var d=a[c];if(b===d.id)return d}return null},getAll:function(){return h.listFields}})}();
window.athene.checkgroup||function(){var d=window.athene,h=d.dom,c={checkGroups:[]},b=function(a){this._constructor(a);this._init();this._render();this._bindEvent()};b.prototype={_constructor:function(a){if(!a.id)throw Error("CheckGroup控件必须设置id");if(!a.binding)throw Error("CheckGroup控件必须设置binding");if(!a.listKey)throw Error("CheckGroup控件必须设置listKey");if(!a.listValue)throw Error("CheckGroup控件必须设置listValue");c.checkGroups.push(this);this.items=[];this.contentWidth=65;this.selectItems=[];for(var b in a)this[b]=
a[b]},_init:function(){this.changed=!1;this.xtype="checkgroup";this.el=$I(this.id);this.el.closeSelect();d.window.get(this.binding).addItem(this);h.addClass(this.el.get(0),"checkgroup-default")},_render:function(){var a=[];a.push("<div class='checkgroup-wrap'><div class='clear'></div></div>");this.el.html(a.join(""));this.items.length>0&&this._renderItems()},_renderItems:function(){for(var a=[],b=this.items,c=b.length,d=0;d<c;d++)a.push(this._generateItem(d,b[d]));a.push("<div class='clear'></div>");
this.el.find(".checkgroup-wrap").html(a.join(""))},_generateItem:function(a,b){var c=[],d=b[this.listKey]||"",g=b[this.listValue],j=this._isChecked(b);c.push("<div class='checkgroup-item'><div class='checkgroup-item-icon-wrap'>");c.push("<div class='checkgroup-item-icon");j&&c.push(" checkgroup-item-icon-checked");c.push("' biz_value='"+g+"'");j?c.push(" biz_status='checked'"):c.push(" biz_status='uncheck'");c.push("></div></div><div class='checkgroup-item-content' style='width:");c.push(this.contentWidth+
"px;'>"+d+"</div></div>");return c.join("")},_bindEvent:function(){this.el.find(".checkgroup-wrap").click($.proxy(function(a){var b=a.target,c=b.className;if(c.contains("checkgroup-item-icon")||c.contains("checkgroup-item-content"))a=null,c.contains("checkgroup-item-content")?(b=$(b).parent().find(".checkgroup-item-icon"),b.length>0&&(a=b.get(0))):a=b,a&&(b=a.getAttribute("biz_value"),a=a.getAttribute("biz_status"),b&&a&&(b=this.getItem(b))&&(a==="checked"?this.removeSelectItem(b):a==="uncheck"&&
this.addSelectItem(b)))},this))},_isChecked:function(a){for(var b=this.listValue,c=this.selectItems,d=c.length,g=0;g<d;g++)if(c[g][b]===a[b])return!0;return!1},getItem:function(a){if(a==void 0||this.items.length==0)return null;for(var b=this.listValue,c=this.items,d=c.length,g=0;g<d;g++){var j=c[g];if(j[b]==a)return j}return null},addSelectItem:function(a){if(a){this.selectItems.push(a);var b=this.el.find("div.checkgroup-item-icon[biz_value='"+a[this.listValue]+"']");if(b.length>0)h.addClass(b.get(0),
"checkgroup-item-icon-checked"),this.changed=!0,b.attr("biz_status","checked"),this.onAddSelectItem&&this.onAddSelectItem.call(this,a)}return this},removeSelectItem:function(a){var b=void 0;if(a){for(var c=this.listValue,d=this.selectItems,g=d.length,j=0;j<g;j++){var w=d[j];if(w[c]===a[c]){b=w;d.splice(j,1);break}}if(b&&(a=this.el.find("div.checkgroup-item-icon[biz_value='"+b[c]+"']"),a.length>0))h.removeClass(a.get(0),"checkgroup-item-icon-checked"),this.changed=!0,a.attr("biz_status","uncheck"),
this.onRemoveSelectItem&&this.onRemoveSelectItem.call(this,b)}return this},_destory:function(){for(var a=c.checkGroups,b=a.length,d=0;d<b;d++)if(this.id===a[d].id){a.splice(d,1);break}this.el.find(".checkgroup-wrap").unbind();this.el.remove()}};d.addModule("checkgroup",{create:function(a){return{widgetId:(new b(a)).id,xtype:"checkgroup"}},get:function(a){for(var b=c.checkGroups,d=b.length,h=0;h<d;h++){var g=b[h];if(a===g.id)return g}return null},getAll:function(){return c.checkGroups}})}();
window.athene.message||function(){var d=window.athene,h=window,c=d.env,b={MESSAGES:[]},a=function(a){b.MESSAGES.push(this);this._constructor(a);this._render()};a.prototype={_constructor:function(a){this.speed=500;this.height=130;this.width=200;this.delay=2E3;this.closeable=!1;for(var b in a)this[b]=a[b]},_render:function(){var a=d.util.getTimestamp();$("body").append(c.get("message").replaceAll("{number}",a));this.id="message-"+a;this.el=$I(this.id);this.el.closeSelect();this.closeable===!1&&this.el.find(".message-panel-close").remove();
this._bindEvent();this.setTitle(this.title||"提示");this.setMessage(this.message);this.setSize(this.width,this.height);this.setPosition();this.start()},_bindEvent:function(){this.closeable===!0&&this.el.find(".message-panel-close").click($.proxy(function(a){this.stop(!0);a.stopPropagation()},this))},setTitle:function(a){a&&this.el.find(".message-panel-title-font").html(a)},setMessage:function(a){a&&this.el.find(".message-panel-message-box").html(a)},setSize:function(a,b){var c=this.el;c.width(a-2);
c.find(".message-panel-message").height(b-25-2-10).width(a-2-10)},setPosition:function(){var a=$(h),b=this.el.get(0).style,c=a.width(),a=a.height();b.top=a+"px";b.left=c-this.width-1+"px"},setIndex:function(){var a=1;this.index?a=this.index:this.index=a=$I("desktop-t-default").css("zIndex")-10;this.el.css("zIndex",a)},start:function(){var a=this.el,b=this.speed,c=$(h).height(),d=$I("desktop-t-default").outerHeight(!0);this.setIndex();a.show();this.closeable===!1?a.animate({top:c-this.height-d+"px",
zIndex:this.index},b).delay(this.delay).animate({top:c+"px"},b,$.proxy(function(){this.stop()},this)):a.animate({top:c-this.height-d+"px",zIndex:this.index},b)},stop:function(a){for(var d=b.MESSAGES,h=d.length,g=0;g<h;g++){var j=d[g];if(j&&j.id===this.id){d.splice(g,1);break}}this.closeable===!0&&this.el.find(".message-panel-close").unbind();a===!0?this.el.fadeOut(c.get("speed"),$.proxy(function(){this.el.remove()},this)):this.el.remove()}};d.addModule("message",{getAll:function(){return b.MESSAGES},
openMessage:function(c){for(var d=b.MESSAGES,h=d.length,g=0;g<h;g++){var j=d[g];c.closeable===!0?j&&j.stop():j.closeable===!0?(j&&j.setIndex(),j&&(c.index=j.index+1)):j&&j.stop()}new a(c)}})}();
window.athene.page||function(){var d=window.athene,h=window,c=d.env,b=d.windowmanager;d.addModule("page",{addBusiness:function(a){if(a)for(k in a){if(this[k])throw Error(k+"已定义");this[k]=a[k]}},login:function(){var a=$I("login-table");$.ajax({type:"POST",context:this,url:"doLogin",cache:!1,data:{args:json(a.getRow())},dataType:"json",beforeSend:function(){this.showMask("正在登陆，请稍等...");a.find(".fm-error").hide().find(".fm-error-content").empty()},success:function(b){this.hideMask(function(){if(b.returnCode===
1)for(var d=b.validationErrors,h=0;h<d.length;h++)a.find("#"+d[h].id).show().find(".fm-error-content").html(d[h].message);else if(b.returnCode===3)alert(b.exceptionDesc);else if(b.returnCode===0)window.location.href=c.get("baseUrl")})}})},loginOut:function(){h.location.href="loginOut"},showMask:function(a,b){var i=$I("mask-loading");i.length===0&&(i=c.get("mask").replaceAll("{mask-id}","mask-loading").replaceAll("{overlay-id}","mask-overlay"),$("body").prepend(i),i=$I("mask-loading").closeSelect());
i.find(".mask-content").html(a||"正在处理，请稍等...");var h=$I("mask-overlay"),g=d.core.getActiveWindowSize(),j=g.width,g=g.height,w=(j-i.outerWidth(!0))/2,t=(g-i.outerHeight(!0))/2;h.width(j);h.height(g);b===!1||h.css("opacity",0.7).css("left","0px").css("top","0px").css("zIndex",15E3).show();i.css("top",t+"px");i.css("left",w+"px").css("zIndex",15001).show()},hideMask:function(a){$I("mask-loading").fadeOut(0,function(){$I("mask-overlay").fadeOut(c.get("speed"),function(){a&&a.call(h)})})},gridSearch:function(a,
b){var c=$I(a).getRow();athene.grid.get(b).query(c)},systemManager:function(a){b.get("window-manager-default").openWindow({width:500,height:500,title:"系统管理",url:"systemManagerList",initPosition:$(a).find(".dm-icon").offset(),maxButton:!1,iconCls:"icon-system-manager"})},userOwnManager:function(a){b.get("window-manager-default").openWindow({width:600,height:250,title:"个人资料更新",url:"userOwnEdit",initPosition:$(a).find(".dm-icon").offset(),iconCls:"icon-user-own-manager",maxButton:!1,onClose:function(){this.floatMessage&&
athene.message.openMessage({message:this.floatMessage})}})},passwordManager:function(a){b.get("window-manager-default").openWindow({width:350,height:220,title:"修改密码",url:"passwordEdit",initPosition:$(a).offset(),maxButton:!1,onClose:function(){this.floatMessage&&athene.message.openMessage({message:this.floatMessage})}})}});h.page=d.page}();
(function(){var d=window.athene,h=d.windowmanager;d.page.addBusiness({teacherManager:function(c){h.get("window-manager-default").openWindow({width:900,height:400,title:"教师管理",url:"teacherList",initPosition:$(c).find(".dm-icon").offset(),iconCls:"icon-teacher-manager",onSetSize:function(b,a){var c=athene.grid.get("teacher-list-"+this.number);if(c){var d=this.el.find(".search-frame").outerHeight(!0),h=this.el.find(".search-button").outerHeight(!0);c.setSize(b,a-d-h)}}})},teacherAdd:function(c,b){h.get("window-manager-default").openWindow({title:"新增教师",
url:"teacherAdd",initPosition:$(b).offset(),maxButton:!1,data:{openerNumber:c.openerNumber},width:600,height:500,onClose:function(){var a=athene.grid.get("teacher-list-"+c.openerNumber);a&&a.refreshSubmit();this.floatMessage&&athene.message.openMessage({message:this.floatMessage})}})},teacherEdit:function(c,b){h.get("window-manager-default").openWindow({title:c.title,url:"teacherEdit",initPosition:$(b).offset(),data:{id:c.id,openerNumber:c.openerNumber},width:600,height:500,maxButton:!1,onClose:function(){var a=
athene.grid.get("teacher-list-"+c.openerNumber);a&&a.refreshSubmit();this.floatMessage&&athene.message.openMessage({message:this.floatMessage})}})},teacherView:function(c,b){h.get("window-manager-default").openWindow({title:c.title,url:"teacherView",initPosition:$(b).offset(),maxButton:!1,data:{id:c.id,openerNumber:c.openerNumber},width:500,height:400})},teacherScheduleView:function(c,b){h.get("window-manager-default").openWindow({title:c.title,url:"teacherScheduleView",initPosition:$(b).offset(),
data:{id:c.id},width:1100,height:500})},teacherScheduleExcel:function(c){var b="teacherScheduleExcel";c&&(b+="?action=download",b+="&id="+c,window.open(b))}})})();
(function(){var d=window.athene,h=d.windowmanager;d.page.addBusiness({studentManager:function(c){h.get("window-manager-default").openWindow({width:750,height:450,title:"学生管理",url:"studentList",initPosition:$(c).find(".dm-icon").offset(),iconCls:"icon-student-manager",onSetSize:function(b,a){var c=athene.grid.get("student-list-"+this.number);if(c){var d=this.el.find(".search-frame").outerHeight(!0),h=this.el.find(".search-button").outerHeight(!0);c.setSize(b,a-d-h)}}})},studentEdit:function(c,b){h.get("window-manager-default").openWindow({title:c.title,
url:"studentEdit",initPosition:$(b).offset(),maxButton:!1,data:{id:c.id,openerNumber:c.openerNumber},width:600,height:500,onClose:function(){var a=athene.grid.get("student-list-"+c.openerNumber);a&&a.refreshSubmit();this.floatMessage&&athene.message.openMessage({message:this.floatMessage})}})},studentAdd:function(c,b){h.get("window-manager-default").openWindow({title:"新增学生",url:"studentAdd",initPosition:$(b).offset(),maxButton:!1,data:{openerNumber:c.openerNumber},width:600,height:500,onClose:function(){var a=
athene.grid.get("student-list-"+c.openerNumber);a&&a.refreshSubmit();this.floatMessage&&athene.message.openMessage({message:this.floatMessage})}})},studentView:function(c,b){h.get("window-manager-default").openWindow({title:c.title,url:"studentView",initPosition:$(b).offset(),maxButton:!1,data:{id:c.id,openerNumber:c.openerNumber},width:500,height:400})},studentListExcel:function(c){var c=$I(c).getRow(),b="studentListExcel";if(c){b+="?action=download";for(var a in c)b+="&"+a+"="+c[a]}window.open(b)}})})();
(function(){var d=window.athene,h=d.windowmanager,c=d.listfield;d.page.addBusiness({lessonManager:function(b){h.get("window-manager-default").openWindow({width:800,height:500,title:"课程管理",url:"lessonList",initPosition:$(b).find(".dm-icon").offset(),iconCls:"icon-lesson-manager",onSetSize:function(a,b){var c=athene.grid.get("lesson-list-"+this.number);if(c){var d=this.el.find(".search-frame").outerHeight(!0),g=this.el.find(".search-button").outerHeight(!0);c.setSize(a,b-d-g)}}})},lessonAdd:function(b,
a){h.get("window-manager-default").openWindow({title:"新增课程",url:"lessonAdd",initPosition:$(a).offset(),maxButton:!1,data:{openerNumber:b.openerNumber},width:600,height:500,onClose:function(){var a=athene.grid.get("lesson-list-"+b.openerNumber);a&&a.refreshSubmit();this.floatMessage&&athene.message.openMessage({message:this.floatMessage})}})},lessonEdit:function(b,a){h.get("window-manager-default").openWindow({title:"编辑课程",url:"lessonEdit",initPosition:$(a).offset(),maxButton:!1,data:{id:b.id,openerNumber:b.openerNumber},
width:600,height:500,onClose:function(){var a=athene.grid.get("lesson-list-"+b.openerNumber);a&&a.refreshSubmit();this.floatMessage&&athene.message.openMessage({message:this.floatMessage})}})},lessonTeacher:function(b,a){h.get("window-manager-default").openWindow({title:"选择教师",url:"lessonTeacher",initPosition:$(a).offset(),maxButton:!1,data:{openerNumber:b.openerNumber},width:600,height:500})},lessonTeacherSelect:function(b){var a=c.get("teacher-name-list-"+b.number).getItems();if(a.length==0)$I("teacher-name-list-"+
b.number+"-error").show().find(".fm-error-content").html("请选择一个教师");else{var f=d.window.get(b.number);f.onClose=function(){var f=c.get("teacher-name-list-"+b.openerNumber);f&&f.setItems(a)};f.close()}},lessonStudent:function(b,a){h.get("window-manager-default").openWindow({title:"选择学生",url:"lessonStudent",initPosition:$(a).offset(),maxButton:!1,data:{openerNumber:b.openerNumber},width:600,height:500})},lessonStudentSelect:function(b){var a=c.get("student-name-list-"+b.number).getItems();if(a.length==
0)$I("student-name-list-"+b.number+"-error").show().find(".fm-error-content").html("请选择一个学生");else{var f=d.window.get(b.number);f.onClose=function(){var f=c.get("student-name-list-"+b.openerNumber);f&&f.setItems(a)};f.close()}},lessonPlanAdd:function(b,a){h.get("window-manager-default").openWindow({title:"新增课程安排",url:"lessonPlanAdd",initPosition:$(a).offset(),maxButton:!1,data:{openerNumber:b.openerNumber},width:350,height:300})},lessonDayStatistics:function(b){h.get("window-manager-default").openWindow({title:"课程统计分布",
url:"lessonDayStatistics",initPosition:$(b).offset(),width:1235,height:500})},lessonPlanEdit:function(b,a){var c=d.grid.get(b.gridId).items[b.index];h.get("window-manager-default").openWindow({title:"编辑课程安排",url:"lessonPlanEdit",initPosition:$(a).offset(),maxButton:!1,data:{lessonPlan:c,index:b.index,openerNumber:b.openerNumber},width:350,height:300})}})})();
(function(){var d=window.athene,h=d.page,c=d.windowmanager;h.addBusiness({expenseManager:function(b){c.get("window-manager-default").openWindow({width:800,height:500,title:"支出管理",url:"expenseList",iconCls:"icon-expense-manager",initPosition:$(b).find(".dm-icon").offset(),onSetHtml:function(){h.querySimpleTodayAccountStatistics(this.number)},onSetSize:function(a,b){var c=athene.grid.get("expense-list-"+this.number);if(c){var d=this.el.find(".search-frame").outerHeight(!0),g=this.el.find(".search-button").outerHeight(!0),
h=this.el.find(".account-statistics-view").outerHeight(!0);c.setSize(a,b-d-g-h)}}})},expenseAdd:function(b,a){c.get("window-manager-default").openWindow({title:"新增支出",url:"expenseAdd",initPosition:$(a).offset(),maxButton:!1,data:{openerNumber:b.openerNumber},width:350,height:400,onClose:function(){var a=athene.grid.get("expense-list-"+b.openerNumber);a&&a.refreshSubmit();this.floatMessage&&athene.message.openMessage({message:this.floatMessage})}})},expenseEdit:function(b,a){c.get("window-manager-default").openWindow({title:b.title,
url:"expenseEdit",initPosition:$(a).offset(),maxButton:!1,data:{id:b.id,openerNumber:b.openerNumber},width:350,height:400,onClose:function(){var a=athene.grid.get("expense-list-"+b.openerNumber);a&&a.refreshSubmit();this.floatMessage&&athene.message.openMessage({message:this.floatMessage})}})},expenseListExcel:function(b){var b=$I(b).getRow(),a="expenseListExcel";if(b){a+="?action=download";for(var c in b)a+="&"+c+"="+b[c]}window.open(a)}})})();
(function(){var d=window.athene,h=d.page,c=d.windowmanager;h.addBusiness({incomeManager:function(b){c.get("window-manager-default").openWindow({width:800,height:500,title:"收入管理",url:"incomeList",iconCls:"icon-income-manager",initPosition:$(b).find(".dm-icon").offset(),onSetHtml:function(){h.querySimpleTodayAccountStatistics(this.number)},onSetSize:function(a,b){var c=athene.grid.get("income-list-"+this.number);if(c){var d=this.el.find(".search-frame").outerHeight(!0),g=this.el.find(".search-button").outerHeight(!0),
h=this.el.find(".account-statistics-view").outerHeight(!0);c.setSize(a,b-d-g-h)}}})},incomeAdd:function(b,a){c.get("window-manager-default").openWindow({title:"新增收入",url:"incomeAdd",initPosition:$(a).offset(),maxButton:!1,data:{openerNumber:b.openerNumber},width:350,height:400,onClose:function(){var a=athene.grid.get("income-list-"+b.openerNumber);a&&a.refreshSubmit();this.floatMessage&&athene.message.openMessage({message:this.floatMessage})}})},incomeEdit:function(b,a){c.get("window-manager-default").openWindow({title:b.title,
url:"incomeEdit",initPosition:$(a).offset(),maxButton:!1,data:{id:b.id,openerNumber:b.openerNumber},width:350,height:400,onClose:function(){var a=athene.grid.get("income-list-"+b.openerNumber);a&&a.refreshSubmit();this.floatMessage&&athene.message.openMessage({message:this.floatMessage})}})},incomeListExcel:function(b){var b=$I(b).getRow(),a="incomeListExcel";if(b){a+="?action=download";for(var c in b)a+="&"+c+"="+b[c]}window.open(a)}})})();
(function(){var d=window.athene,h=d.windowmanager;d.page.addBusiness({taskManager:function(c){h.get("window-manager-default").openWindow({width:800,height:400,title:"任务管理",url:"taskList",iconCls:"icon-task-manager",initPosition:$(c).find(".dm-icon").offset(),onSetSize:function(b,a){var c=athene.grid.get("task-list-"+this.number);if(c){var d=this.el.find(".search-frame").outerHeight(!0),h=this.el.find(".search-button").outerHeight(!0);c.setSize(b,a-d-h)}}})},taskAdd:function(c,b){h.get("window-manager-default").openWindow({title:"新增任务",
url:"taskAdd",initPosition:$(b).offset(),maxButton:!1,data:{openerNumber:c.openerNumber},width:400,height:400,onClose:function(){var a=athene.grid.get("task-list-"+c.openerNumber);a&&a.refreshSubmit();this.floatMessage&&athene.message.openMessage({message:this.floatMessage})}})},taskEdit:function(c,b){h.get("window-manager-default").openWindow({title:c.title,url:"taskEdit",initPosition:$(b).offset(),maxButton:!1,data:{id:c.id,openerNumber:c.openerNumber},width:400,height:400,onClose:function(){var a=
athene.grid.get("task-list-"+c.openerNumber);a&&a.refreshSubmit();this.floatMessage&&athene.message.openMessage({message:this.floatMessage})}})}})})();
(function(){var d=window.athene,h=d.page,c=d.dialog,b=d.windowmanager;h.addBusiness({accountStatisticsManager:function(a){b.get("window-manager-default").openWindow({width:550,height:500,title:"账户查询",url:"accountStatisticsList",initPosition:$(a).find(".dm-icon").offset(),iconCls:"icon-account-statistics-manager",onSetHtml:function(){h.queryTodayAccountStatistics(this.number)},onSetSize:function(a,b){var c=athene.grid.get("account-statistics-list-"+this.number);if(c){var d=this.el.find(".search-frame").outerHeight(!0),
h=this.el.find(".search-button").outerHeight(!0),w=this.el.find(".account-statistics-view").outerHeight(!0);c.setSize(a,b-d-h-w)}}})},querySimpleTodayAccountStatistics:function(a){var b=$I("simple-account-statistics-today-"+a);$.ajax({type:"POST",url:"accountStatisticsTodaySimpleView",cache:!1,dataType:"html",beforeSend:function(){b.html("<img style='margin:3px 5px;' src='images/mask/loading.gif'>");var c=athene.window.get(a);c&&c.onSetSize&&c.onSetSize.call(c,c.width,c.height)},success:function(c){b.empty().append(c);
(c=athene.window.get(a))&&c.onSetSize&&c.onSetSize.call(c,c.width,c.height)}})},queryTodayAccountStatistics:function(a){var b=$I("account-statistics-today-"+a);$.ajax({type:"POST",url:"accountStatisticsTodayView",cache:!1,dataType:"html",beforeSend:function(){b.html("<img style='margin-left:5px;' src='images/mask/loading.gif'>");var c=athene.window.get(a);c&&c.onSetSize&&c.onSetSize.call(c,c.width,c.height)},success:function(c){b.html(c);(c=athene.window.get(a))&&c.onSetSize&&c.onSetSize.call(c,c.width,
c.height)}})},accountStatisticsListExcel:function(a){var a=$I(a).getRow(),b="accountStatisticsListExcel";if(a){b+="?action=download";for(var c in a)b+="&"+c+"="+a[c]}window.open(b)},accountStatisticsGenerate:function(){c.confirm("确认重新生成统计账目？",function(a){a!==!1&&$.ajax({type:"POST",context:this,url:"accountStatisticsGenerate",cache:!1,dataType:"json",beforeSend:function(){this.showMask("正在生成统计账目，请稍等...")},success:function(a){this.hideMask(function(){a.returnCode===3?athene.dialog.alertException(a.exceptionDesc):
athene.message.openMessage({message:"重新生成统计账目成功"})})}})},this,300)}})})();
